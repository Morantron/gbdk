<html>
<head>
<title>Commands of s51</title>
</head>

<body bgcolor="white">

<h1>Command reference of ucsim</h1>

<a href="#general">General commands and information</a>

<ul><li><a href="#show"><b>show</b> Show licensing information</a> (<font color="#ff2211">since 0.1.3</font>)
<li><a href="#l"><b>l</b> Load (intel hexa) file</a>
<li><a href="#dl"><b>dl,do</b> Download (intel hex) data</a>
<li><a href="#q"><b>q</b> Quit</a>
(<font color="#ff2211">changed 0.2.12</font>)
<li><a href="#q"><b>quit</b> Quit</a>
<li><a href="#kill"><b>kill</b> Shut down the simulator</a>
(<font color="#ff2211">since 0.2.12</font>)
<li><a href="#h"><b>h,?</b> Help about commands</a>
<li><a href="#reset"><b>reset</b> Reset</a>
<li><a href="#wi"><b>wi,Wi</b> Search for string in Internal RAM</a>
<li><a href="#wi"><b>wx,Wx</b> Search for string in External RAM</a>
<li><a href="#wi"><b>wc,Wc</b> Search for string in ROM</a>
<li><a href="#gopt"><b>gopt</b> Get value of option(s)</a>
<li><a href="#sopt"><b>sopt</b> Set value of option</a>
<li><a href="#conf"><b>conf</b> Configuration</a> (<font color="#ff2211">since 0.2.20</font>)<img src="new.gif">
<li><a href="#state"><b>state</b> State of simulator</a> (<font color="#ff2211">since 0.2.19</font>)<img src="new.gif">
<li><a href="#file"><b>file FILE</b> Load FILE into ROM</a> (<font
color="#ff2211">since 0.2.24</font>)<img src="new.gif">
<li><a href="#info"><b>info</b> Information</a> (<font color="#ff2211">since 0.2.20</font>)<img src="new.gif">
<li><a href="#timer"><b>timer a|d|g|r|s|v id [value]</b> Timer add|del|get|run|stop|value</a> (<font color="#ff2211">since 0.2.19</font>)<img src="new.gif">
</ul>

<a href="#execution">Execution</a>

<ul><li><a href="#g"><b>g</b> Go</a> (<font color="#ff2211">changed 0.2.12</font>)
<li><a href="#stop"><b>stop</b> Stop</a> (<font color="#ff2211">since 0.2.12</font>)
<li><a href="#s"><b>s</b> Step</a>
<li><a href="#n"><b>n</b> Next</a>
<li><a href="#pc"><b>pc</b> Set/get PC</a> (<font color="#ff2211">since 0.1.5</font>)
<li><a href="#run"><b>run</b> Go</a> (<font color="#ff2211">since 0.2.20</font>)<img src="new.gif">
</ul>

<a href="#breakpoints">Breakpoints</a>

<ul><li><b>bs</b> Set FETCH Breakpoint (<font color="#ff2211">removed
0.2.20, use <a href="#break">break</a> or <a href="#tbreak">tbreak</a>
instead</font>)
<li><a href="#bse"><b>bse</b> Set EVENT Breakpoint</a>
<li><b>bd</b> Delete FETCH Breakpoint (<font color="#ff2211">removed
0.2.20</font>, use <a href="#clear">clear</a> instead)
<li><a href="#bde"><b>bde</b> Delete EVENT Breakpoint</a>
<li><a href="#ba"><b>ba</b> Delete all breakpoints</a>
<li><b>bl</b> List Breakpoints (<font color="#ff2211">removed 0.2.20,
use <a href="#info">info breakpoints</a> instead</font>)
<li><a href="#break"><b>break</b> Set fix breakpoint</a> (<font color="#ff2211">since 0.2.20</font>)<img src="new.gif">
<li><a href="#tbreak"><b>tbreak</b> Set fix breakpoint</a> (<font color="#ff2211">since 0.2.20</font>)<img src="new.gif">
<li><a href="#clear"><b>clear</b> Clear fix breakpoint</b> (<font color="#ff2211">since 0.2.20</font>)<img src="new.gif">
</ul>

<a href="#dump">Dump commands</a>

<ul><li><a href="#dis"><b>dis</b> Disassemble</a>
<li><a href="#dc"><b>dc</b> Dump code in disass format</a>
<li><a href="#dch"><b>dch</b> Dump code in hex format</a>
<li><a href="#di"><b>di</b> Dump Internal RAM</a>
<li><a href="#dx"><b>dx</b> Dump External RAM</a>
<li><a href="#dr"><b>dr</b> Dump registers</a>
<li><a href="#dp"><b>dp</b> Dump ports</a>
<li><a href="#ds"><b>ds</b> Dump SFR</a>
<li><a href="#db"><b>db</b> Dump bit</a></ul>

<a href="#set">Set commands</a>

<ul><li><a href="#si"><b>si</b> Set Internal RAM</a>
<li><a href="#sx"><b>sx</b> Set External RAM</a>
<li><a href="#sc"><b>sc</b> Set code (ROM)</a>
<li><a href="#ss"><b>ss</b> Set SFR area</a>
<li><a href="#sb"><b>sb</b> Set bit</a>
<li><a href="#sp"><b>sp</b> Set port pins</a>
<li><a href="#fi"><b>fi</b> Fill IRAM area with data</a>
<li><a href="#fx"><b>fx</b> Fill XRAM area with data</a>
<li><a href="#fs"><b>fs</b> Fill SFR area with data</a>
<li><a href="#fc"><b>fc</b> Fill ROM area with data</a>
</ul>

<hr>

                                                              <!-- GENERAL -->

<h2><a name="general">General commands</a></h2>

Some commands can be repeated by entering an empty command (just
pressing ENTER if command console is interactive). This repeats the
<b>full</b> command entered previously precisely including parameters
of the command. Repeatable commands are signed with <img
src="burst.gif" alt="[Repeatable]"> icon.

<p>Some commands accept parameters which in most cases can be
numbers. Numbers can be entered in C-style form. If the number begins
whith <tt><b>0x</b></tt> or <tt><b>0X</b></tt> it is interpreted as a
hexadecimal number. If it begins with <tt><b>0</b></tt> followed by
digits it is interpreted as octal number. In other cases it is
interpreted as decimal number.

<p>Every command which changes content of ROM area such as <b><a
href="#l">l</a></b>, <b><a href="#dl">dl</a></b> or <b><a
href="#sc">sc</a></b> deletes result of code analyzer and causes to
re-analyze the code.


<a name="show"><h3>show c|w</h3></a>

This command can be used to list licensing information. If <b>c</b>
option has given, the license is listed. It is first 10 point of the
version 2 of GNU Genral Public License. Using <b>w</b> parameter the
command prints out last 2 point of the license ("NO WARRANTY"
message). If you do not accept GPL simply do not use the program.


<a name="l"><h3>l file</h3></a>

Loading specified files into simulated ROM area. File must hold
information in Intel hex form.

<pre>$ <font color="#118811">s51</font>
ucsim 0.2.12, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
> <font color="#118811">l ../remoansi.hex</font>
58659 bytes read from ../remoansi.hex
> </pre>


<a name="dl"><h3>dl,do</h3></a>

Download command. It is same as <a href="#l">load</a> above but it
reads information from command console which is standard input by
default. This command stops read records when it detects an "END"
record which is normaly the last record. This command has two
equivalent forms <b>dl</b> and <b>do</b>.

<pre>
$ <font color="#118811">s51 -V</font>
ucsim 0.2.24, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
> <font color="#118811">do
:03000000020003F8
:1000030075812078207600D8FC900000AE83AF8203
:100013009000001200416005E4F0A380F690009F79
:1000230012004A9000A312004A9000A712006890A1
:1000330000AD12006875D0001200B50200B3EF6581
:10004300827003EE658322E493F8740193F97402DA
:1000530093FE740393F5828E83E869700122E4931F
:10006300F6A30880F4E493FC740193FD740293FEF9
:10007300740393FF740493F8740593F582888312D1
:100083000041700122E493A3A883A9828C838D820B
:10009300F0A3AC83AD828883898280E3212100B5FC
:1000A300212100B5000000B500B5000000B500B582
:0200B30080FECD
:1000B5007520117501AA850120750102850120228F
:00000001FF</font>
15 records have been read
197 bytes read
> </pre>


<a name="q"><h3>q, quit</h3></a>

Quit. This command terminates actual console, it does not ask you to
confirm your intention. Simulator always reads commands from a file so
end of file condition finishes too. If command console is on standard
input/output, pressing the CTRL-D will quit just like the quit
command.

<p>Note that if <a href="index.html#Zoption">-Z option</a> was used at
invokation then the quit command does not terminate the simulator
program. In this case <a href="#kill">kill</a> command can be used to
terminate the simulator. See for more information about <a
href="mulcons.html">using multiple consoles</a>.

<pre>$ <font color="#118811">s51</font>
ucsim 0.2.24, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
> <font color="#118811">q</font>
$ </pre>


<a name="kill"><h3>kill</h3></a>

This kommand terminates the simulator. It does not ask for
confirmation. It doesn't matter how many consoles are used and what
commands are running on them.


<a name="h"><h3>h,?</h3></a>

Help command. It prints out short description of the commands.

<p><a href="commref.html#help_example">Example</a>


<a name="res"><h3>reset</h3></a>

Reset command. It resets the microcontroller. It has same effect as
active signal on the RST pin.

<pre>
$ <font color="#118811">s51 -V remoansi.hex</font>
ucsim 0.2.24, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
58659 bytes read from remoansi.hex
> <font color="#118811">dr</font>
000000 00 00 00 00 00 00 00 00 ........
000000 00 .  ACC= 0x00   0 .  B= 0x00   DPTR= 0x0000 @DPTR= 0x00   0 .
000000 00 .  PSW= 0x00 CY=0 AC=0 OV=0 P=0
   000000 02 01 60 LJMP  0160
> <font color="#118811">s 2</font>
000000 00 00 00 00 00 00 00 00 ........
000000 00 .  ACC= 0x00   0 .  B= 0x00   DPTR= 0x0000 @DPTR= 0x00   0 .
000000 00 .  PSW= 0x00 CY=0 AC=0 OV=0 P=0
   000160 c2 90    CLR   P1.0
000000 00 00 00 00 00 00 00 00 ........
000000 00 .  ACC= 0x00   0 .  B= 0x00   DPTR= 0x0000 @DPTR= 0x00   0 .
000000 00 .  PSW= 0x00 CY=0 AC=0 OV=0 P=0
   000162 c2 97    CLR   P1.7
> <font color="#118811">res</font>
> <font color="#118811">dr</font>
000000 00 00 00 00 00 00 00 00 ........
000000 00 .  ACC= 0x00   0 .  B= 0x00   DPTR= 0x0000 @DPTR= 0x00   0 .
000000 00 .  PSW= 0x00 CY=0 AC=0 OV=0 P=0
   000000 02 01 60 LJMP  0160
> </pre>


<a name="wi"><h3>wi,Wi string</h3></a>

Searching for specified string in internal RAM area. String is
interpreted from first non-space sharacter until end of the command
including spaces. <b>wi</b> command makes case insensitive search and
<b>Wi</b> can be used to make case sensitive search. Result is a hexa
dump of memory areas that match with specified string. Most of C-style
escape sequences can be used in the string: <tt>\f</tt>, <tt>\n</tt>,
<tt>\r</tt>, <tt>\t</tt>, <tt>\v</tt>, <tt>\a</tt>, <tt>\b</tt>,
<tt>\0</tt>, and <tt>\0xxx</tt> where <tt>xxx</tt> is an octadecimal
number of the code of the character.

<pre>
$ <font color="#118811">s51 remoansi.hex</font>
ucsim 0.2.24, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
58659 bytes read from remoansi.hex
> <font color="#118811">g</font>
Simulation started, PC=0x000000

Stop at 00019c: (7) User stopped
F 00019c
> <font color="#118811">si 20 Dani DAni</font>
000014 44 61 6e 69 44 41 6e 69                         DaniDAni
> <font color="#118811">wi dani</font>
000014 44 61 6e 69             Dani
000018 44 41 6e 69             DAni
> <font color="#118811">Wi Dani</font>
000014 44 61 6e 69             Dani
> <font color="#118811">wi dani\0</font>
000018 44 41 6e 69 00          DAni.
> </pre>


<a name="wx"><h3>wx,Wx string</h3></a>

Search commands. These commands are similar to <a href="#wi"><b>wi,
Wi</b></a> commands the only difference is that <b>wx,Wx</b> are used
to search for a string in external memory.


<a name="wc"><h3>wc,Wc string</h3></a>

Search commands. These commands are similar to <a href="#wi"><b>wi,
Wi</b></a> commands the only difference is that <b>wx,Wx</b> are used
to search for a string in code memory area.


<a name="gopt"><h3>gopt [opt]</h3></a>

Get actual value of option(s). Some options can be set by <a
href="#sopt"><b>sopt</b></a> to modify behavior of the
simulator. Using <b>gopt</b> you can get actual value of these
options. If you use this command without parameter you get list of all
options known by the program. In this way you can figure out which
options can be used.

<pre>
$ <font color="#118811">s51 -V</font>
ucsim 0.2.24, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
> <font color="#118811">gopt</font>
verbose TRUE Verbose flag.
stopit FALSE Stop if interrupt accepted.
debug FALSE Debug flag.
> <font color="#118811">gopt stopit</font>
stopit FALSE Stop if interrupt accepted.
> </pre>

This version of the simulator knows about three options. First element
of the list is name of the option (<b>verbose</b>, <b>debug</b> and
<b>stopit</b>). This name can be used to identify the option in
<b>gopt</b> and <a href="#sopt"><b>sopt</b></a> command. Second
element of the list is the value of the option. In this case type of
both options is boolean, their value can be TRUE or FALSE. Third
element is a short description of the option.

<dl><dt><b>verbose</b> <dd>?

<dt><b>debug</b> <dd>Debug flag can be set by <b>-V</b> option of the
program to TRUE otherwise its default value is FALSE. If it is TRUE,
the simulator prints out short messages about important events.

<dt><b>stopit</b> <dd>Setting this option to TRUE (default value is
FALSE) forces execution to stop every time when CPU accepts an
interrupt. You do not have to use breakpoints to inspect interrupts.

</dl>


<a name="sopt"><h3>sopt opt value</h3></a>

Set option value. Options described at previous command (<a
href="#gopt"><b>gopt</b></a>) can be set using this command. First
parameter must be an option name and second the new
value. Interpretation of the value depends on type of the
option. Value for a boolean type of option interpreted as follows: if
first character of the value is one of <tt>1</tt>, <tt>t</tt>,
<tt>T</tt>, <tt>y</tt>, <tt>Y</tt> then value will be TRUE otherwise
it will be FALSE.

<pre>
$ <font color="#118811">s51 -V</font>
ucsim 0.2.24, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
> <font color="#118811">gopt</font>
verbose TRUE Verbose flag.
stopit FALSE Stop if interrupt accepted.
debug FALSE Debug messages appears on this console.
> <font color="#118811">sopt debug t</font>
> <font color="#118811">gopt</font>
verbose TRUE Verbose flag.
stopit FALSE Stop if interrupt accepted.
debug TRUE Debug messages appears on this console.
> </pre>


<a name="conf"><h3>conf </h3></a>

This command prints out configuration of the simulator:

<pre>
> <font color="#118811">conf</font>
ucsim version 0.2.24
Type of microcontroller: 51 CMOS
Controller has 0 hardware element(s).
Memories:
  ROM  size= 0x010000 65536
  XRAM size= 0x010000 65536
  IRAM size= 0x000100 256
  SFR  size= 0x000100 256
> 
</pre>

First line contains version number of the program. Second line informs
about type of the simulated microcontroller. Third line prints out how
many hardware elements are simulated. This has meaning in AVR
simulator only. Following lines contain information about
memories. Note that size of the simulated memory segment can be bigger
than size of addressable part of the memory as you see above SFR type
of the memory has bigger simulated than addressable size.


<a name="state"><h3>state</h3></a>

State of the simulator and the simulated microcontroller:

<pre>
> <font color="#118811">state</font>
sim state= 0 PC= 0007a9
XTAL= 1.10592e+07
time= 0.306849 sec (3393504 clks) time in isr= 0.00100694 (11136 clks) 0.33%
> 
</pre>

The "sim state" number in the first line is an internal
information. PC is value of the program counter. Second line shows
XTAL frequency.

<p>Third line contains information about simulated time. First, full
simulated time (elapsed from last reset) is printed out in seconds and
number of clock periods then same data is printed out about time spent
in interrupt service routines. Last data shows ratio of ISRs and main
program.


<a name="file"><h3>file "FILE"</h3></a>

Loads file named FILE into the simulated code memory. File must
contain data in Intel HEX format.

<pre>
> <font color="#118811">file "../../remo.hex"</font>
55470 words read from ../../remo.hex
> 
</pre>

Don't forget to enclose file name in quotes to make the parameter to
be a string.


<a name="info"><h3>info</h3></a>

This command prints out information about different things which must
be specified as paramater to the command.

<h4>info breakpoints</h4>

This subcommand prints out information about breakpoints:

<pre>
> <font color="#118811">b 12</font>
Breakpoint 1 at 0x00000c: MOV   R7,A
> <font color="#118811">tb 43</font>
Breakpoint 2 at 0x00002b: MOV   R7,A
> <font color="#118811">bse ws f 0x80</font>
> <font color="#118811">i b</font>
Num Type       Disp Hit   Cnt   Address  What
1   fetch      keep 1     1     0x00000c MOV   R7,A
2   fetch      del  1     1     0x00002b MOV   R7,A
1   event      keep 1     1     0x000080 ws
> 
</pre>

As you see above, the command can be shortened to "i b". The list of
breakpoints contains 7 columns:

<dl><dt><b>Num</b> <dd>Number of the breakpoint. Normal and event
breakpoints are numbered separately.

<dt><b>Type</b> <dd>This column shows type of the breakpoint. It can
be <i>fetch</i> for normal breakpoints or <i>event</i> for event
breakpoints. First the normal breakpoints are listed and then the
event breakpoints.

<dt><b>Disp</b> <dd>This shows if the breakpoint is temporary
(<i>del</i>) or not (<i>keep</i>).

<dt><b>Hit</b> <dd>How many times the breakpoint must be hit before it
really stops the program.

<dt><b>Cnt</b> <dd>Counter of breakpint hits. This counter decrements
and the breakpoint is activated if it reaches zero.

<dt><b>Address</b> <dd>Address where the breakpoint is set.

<dt><b>What</b> <dd>For normal breakpoints this field contains
disassembled instruction where the breakpoint is set. For event
breakpoints it contains type of event.

</dl>


<a name="timer"><h3>timer a|d|g|r|s|v id [value]</h3></a>

Handling of timers. First parameter of timer command determines the
operation which can be

<dl><dt><b>add (or simply a)</b> <dd>to create a new timer. New timers
are turned ON by default and initialized to value 0.

<dt><b>del (or simply d)</b> <dd>to remove a timer if you don't need
it any more.

<dt><b>get (or simply g)</b> <dd>to get value of timers. See comment
below.

<dt><b>run (or simply r)</b> <dd>to turn a timer ON.

<dt><b>stop (or simply s)</b> <dd>to turn a timer OFF. It still exist
but doesn't count xtal periods.

<dt><b>value (or simply v)</b> <dd>to set value of the timer (number
of xtal periods). `param' is the new value.

</dl>

<b>id</b> can be a number or a string. Timers are numbered from 1. You
can use any number greater than 0 to identify a timer. Or you can use
a simbolic name, in this case simulator uses the first unused number
to allocate a new timer:

<pre>
> <font color="#118811">tim a 3</font>
> <font color="#118811">tim g 0</font>
timer #0("time") ON: 0.463255 sec (5123232 clks)
timer #0("isr") ON: 0.0051888 sec (57384 clks)
timer #3("unnamed") ON: 0 sec (0 clks)
> <font color="#118811">tim a "a"</font>
> <font color="#118811">tim g 0</font>
timer #0("time") ON: 0.463255 sec (5123232 clks)
timer #0("isr") ON: 0.0051888 sec (57384 clks)
timer #1("a") ON: 0 sec (0 clks)
timer #3("unnamed") ON: 0 sec (0 clks)
> 
</pre>

If you use 0 as timer id in "get" operation, simulator prints out
value of all timers including predefined ones.

<hr>


                                                                 <!-- EXEC -->

<h2><a name="execution">Execution commands</a></h2>

<a name="g"><h3>g [start [stop]]</h3></a>

Go, start execution. Parameters are optional. First parameter
specifies start address of the execution. By default execution starts
at address specified by actual value of the PC. This can be overridden
by first parameter. If second parameter is specified it places a
dynamic breakpoint at specified address which stops the execution. If
stop address is not given the simulator stops if it reaches a
breakpoint, or the CPU accepts an interrupt and <b>stopit</b> option
is TRUE, or fatal error occures or <a href="#stop">stop</a> command is
used. Note that first instruction is executed without effect of
breakpoints. It means that if there is a breakpoint at start address
then it will not be hit.

<pre>
$ <font color="#118811">s51 remoansi.hex</font>
ucsim 0.2.24, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
55755 bytes read from remoansi.hex
> <font color="#118811">b 0x187</font>
> <font color="#118811">sopt stopit y</font>
> <font color="#118811">g</font>
Simulation started, PC=0x000000
Stop at 000187: (4) Breakpoint
F 000187
> </pre>

After execution is started the <tt>Simulaton started</tt> message
appears with value of PC where the execution started and the simulator
is ready to accept other commands while the simulation is running in
background.

<!--If execution stops the simulator first writes out a number which is
the reason of the stop (this is a diagnostic feature, it will be
improved in future versions). Reason can be:

<dl><dt>0

<dd>There is no reason to stop. This number should never appear.

<dt>1

<dd>Serious error for example unknown instruction code which is
impossible to execute.

<dt>2

<dd>Invalid address used in an instruction. For example indirect
address is bigger then 127 in 51 type of controller. Execution can be
continued but result will be undefined.

<dt>3

<dd>Stack overflow. Execution can be continued but result will be
undefined.

<dt>4

<dd>Breakpoint has been reached.

<dt>5

<dd>Interrupt accepted. It only stops the execution if <b>stopit</b>
option is set to TRUE. See <a href="#sopt">sopt</a> command.

</dl>

After this diagnostic message the simulator prints out intruction at
the PC in disassembled form. See <a href="#dis"><b>dis</b></a>
commands for description of disassembled form.
-->


<a name="stop"><h3>stop</h3></a>

This command stops the simulation, it freezes the CPU and all the
peripherials.

<pre>
$ <font color="#118811">s51 remoansi.hex</font>
ucsim 0.2.24, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
58659 bytes read from remoansi.hex
> <font color="#118811">g</font>
Simulation started
> <font color="#118811">dr</font>
000000 00 01 00 14 00 00 5a 47 ......ZG
000000 00 .  ACC= 0x47  71 G  B= 0x01   DPTR= 0x001c @DPTR= 0x47  71 G
000001 01 .  PSW= 0x00 CY=0 AC=0 OV=0 P=0
   006f02 90 00 1e MOV   DPTR,#001e
> <font color="#118811">stop</font>
   006ac5 24 a5    ADD   A,#a5
> 
</pre>

Simulated program is executed in background and the simulator accepts
commands. If it stopped by the stop command the instruction pointed by
PC is dissassembled, see the <a href="#dis"><b>dis</b></a> command for
description of disassembled form.


<a name="s"><h3><img src="burst.gif" alt="[Repeatable]"> s
[step]</h3></a>

Step command. It executes one instruction without effect of
breakpoints. Optional parameter can specify number of requested
steps.

<pre>
$ <font color="#118811">s51 remoansi.hex</font>
ucsim 0.2.12, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
58659 bytes read from remoansi.hex
> <font color="#118811">s</font>
000000 00 00 00 00 00 00 00 00 ........
000000 00 .  ACC= 0x00   0 .  B= 0x00   DPTR= 0x0000 @DPTR= 0x00   0 .
000000 00 .  PSW= 0x00 CY=0 AC=0 OV=0 P=0
   000160 c2 90    CLR   P1.0
> <font color="#118811">s 2</font>
000000 00 00 00 00 00 00 00 00 ........
000000 00 .  ACC= 0x00   0 .  B= 0x00   DPTR= 0x0000 @DPTR= 0x00   0 .
000000 00 .  PSW= 0x00 CY=0 AC=0 OV=0 P=0
   000162 c2 97    CLR   P1.7
000000 00 00 00 00 00 00 00 00 ........
000000 00 .  ACC= 0x00   0 .  B= 0x00   DPTR= 0x0000 @DPTR= 0x00   0 .
000000 00 .  PSW= 0x00 CY=0 AC=0 OV=0 P=0
   000164 d2 b5    SETB  P3.5
> </pre>

After execution of actual instruction pointed by PC the <b>step</b>
command executes <a href="#dr"><b>dr</b></a> command.


<a name="n"><h3><img src="burst.gif" alt="[Repeatable]"> n
[step]</h3></a>

Execute until next instruction is reached. This command is similar to
<a href="#s"><b>step</b></a> command described above but if actual
instruction to execute is a subroutine call the <b>next</b> command
places a dynamic breakpoint after the call instruction and starts to
execute the subroutine. If the subroutine is infinite the breakpoint
set by <b>next</b> will never reached. It can be a dangerous situation
because the executeion started by the <b>next</b> command can not be
stopped interactively. But it can be stopped by other breakpoints.

<pre>
$ <font color="#118811">s51 remoansi.hex</font>
ucsim 0.2.12, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
58659 bytes read from remoansi.hex
> <font color="#118811">g 0 0x172</font>
4
   000172 79 04    MOV   R1,#04
> <font color="#118811">dis 0x172 0 5</font>
   000170 7f 00    MOV   R7,#00
   000172 79 04    MOV   R1,#04
   000174 12 0d b8 LCALL 0db8
   000177 0f       INC   R7
   000178 d9 fa    DJNZ  R1,0174
   00017a 75 0b 00 MOV   0b,#00
> <font color="#118811">n 3</font>
000000 00 04 00 00 00 00 00 00 ........
000000 00 .  ACC= 0x00   0 .  B= 0x00   DPTR= 0x0000 @DPTR= 0x00   0 .
000004 00 .  PSW= 0x00 CY=0 AC=0 OV=0 P=0
   000174 12 0d b8 LCALL 0db8
000000 00 04 00 00 00 00 00 00 ........
000000 00 .  ACC= 0x00   0 .  B= 0x00   DPTR= 0x0167 @DPTR= 0x00   0 .
000004 00 .  PSW= 0x00 CY=0 AC=0 OV=0 P=0
   000177 0f       INC   R7
000000 00 04 00 00 00 00 00 01 ........
000000 00 .  ACC= 0x00   0 .  B= 0x00   DPTR= 0x0167 @DPTR= 0x00   0 .
000004 00 .  PSW= 0x00 CY=0 AC=0 OV=0 P=0
   000178 d9 fa    DJNZ  R1,0174
> </pre>


<a name="pc"><h3>pc [address]</h3></a>

Using this command without any parameter it simply dumps out
instruction pointed by the PC. Specify address if you want to set the
PC.

<pre>
$ s51
S51 0.1.5, Copyright (C) 1997 Daniel Drotos, Talker Bt.
S51 comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
> <font color="#118811">pc</font>
 * 000000 ff       MOV   R7,A
> <font color="#118811">pc 123</font>
 * 00007b ff       MOV   R7,A
> <font color="#118811">sopt debug t </font> 
> <font color="#118811">pc 32</font>
Warning: maybe not instruction at 000020
 * 000020 ff       MOV   R7,A
> </pre>


<a name="run"><h3>run</h3></a>

This command starts the execution of the simulated program.


<hr>


                                                          <!-- BREAKPOINTS -->

<h2><a name="breakpoints">Commands to manage breakpoints</a></h2>

Two kind of breakpoints can be used: fetch and event
breakpoint. <B>Fetch</b> breakpoints are classical breakpoints. They
can be placed at any instruction in the code memory. Breakpoint will
be hit if CPU fetches instruction code from the memory location
specified by the breakpoint. Only fetching of first byte of the
instruction hits the breakpoint. If the execution reaches a breakpoint
it stops <i>before</i> the instruction at location specified by the
breakpoint would be executed.

<p><b>Event</b> breakpoints are special onces. They cause stop of
execution if event specified by the breakpoint occures. Events are:

<dl><dt><b>wi</b> <dd>writing into internal RAM at specified location;

<dt><b>ri</b> <dd>reading from internal RAM at specified address;

<dt><b>wx</b> <dd>writing into external RAM at specified location
(MOVX instruction);

<dt><b>rx</b> <dd>reading from external RAM at specified address (MOVX
instruction);

<dt><b>ws</b> <dd>writing into SFR area at specified location;

<dt><b>rs</b> <dd>reading from SFR area at specified address;

<dt><b>rc</b> <dd>reading from code memory at specified location (MOVC
instruction).</dl>

Event breakpoint stops execution <i>after</i> specified event occured.

<p>Every breakpoint can be <b>fix</b> (permanent) or <b>dynamic</b>
(temporary). Dynamic breakpoints are automatically removed when they
reached. Some commands place dynamic fetch breakpoints into the code,
for example <a href="#g"><b>go</b></a> or <a
href="#n"><b>next</b></a>.

<p>A <b>hit number</b> can be associated to any breakpoint. This hit
number specifies how many times the breakpoint must be hit before it
causes the execution to stop. This hit number is 1 by default.


<a name="break"><h3>break addr [hit]</h3></a>
<a name="tbreak"><h3>tbreak addr [hit]</h3></a>

Set fetch breakpoint. The command specifies if the breakpoint will be
fix (<b>break</b>) or dynamic (temporary) (<b>tbreak</b>). First
parameter specifies address where the breakpoint must be placed to. It
should be address of an instruction.

<p>Second parameter is optional and it specifies the hit number. It is
1 by default.

<pre>
$ <font color="#118811">s51 remoansi.hex</font>
ucsim 0.2.24, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
58659 bytes read from remoansi.hex
> <font color="#118811">dc 0 0x10</font>
   000000 02 01 60 LJMP  0160
 * 000003 02 00 3c LJMP  003c
 * 000006 ff       MOV   R7,A
 * 000007 ff       MOV   R7,A
 * 000008 ff       MOV   R7,A
 * 000009 ff       MOV   R7,A
 * 00000a ff       MOV   R7,A
 * 00000b 02 3b e0 LJMP  3be0
 * 00000e ff       MOV   R7,A
 * 00000f ff       MOV   R7,A
 * 000010 ff       MOV   R7,A
> <font color="#118811">break 0x160</font>
Breakpoint 1 at 0x000160: CLR   P1.0
> <font color="#118811">tbreak 8 2</font>
Breakpoint 2 at 0x000008: MOV   R7,A
> <font color="#118811">g</font>
Simulation started, PC=0x000000
Stop at 000160: (4) Breakpoint
F 000160
> </pre>


<a name="bse"><h3>bse wi|ri|wx|rx|ws|rs|rc f|d addr [hit]</h3></a>

Set event breakpoint. First parameter specifies type of event. See <a
href="#breakpoints">general description of event breakpoints</a> above
about meaning of event identifiers. Second parameter specify if the
breakpoint will be fix (<b>f</b>) or dynamic (<b>d</b>). Third
parameter specifies address. Remember that this is not an instruction
address, it is address of the memory cell where specified event should
occur.

<p>Forth parameter is optional and it specifies the hit number. It is
1 by default.

<pre>
$ <font color="#118811">s51 remoansi.hex</font>
ucsim 0.2.12, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
58659 bytes read from remoansi.hex
> <font color="#118811">dis</font>
   00d47e 22       RET
   000000 02 01 60 LJMP  0160
   000160 c2 90    CLR   P1.0
   000162 c2 97    CLR   P1.7
   000164 d2 b5    SETB  P3.5
   000166 d2 b4    SETB  P3.4
   000168 75 81 22 MOV   SP,#22
   00016b 75 d0 00 MOV   PSW,#00
   00016e 7e 00    MOV   R6,#00
   000170 7f 00    MOV   R7,#00
   000172 79 04    MOV   R1,#04
   000174 12 0d b8 LCALL 0db8
   000177 0f       INC   R7
   000178 d9 fa    DJNZ  R1,0174
   00017a 75 0b 00 MOV   0b,#00
   00017d 75 0c 00 MOV   0c,#00
   000180 02 02 2a LJMP  022a
   000183 78 22    MOV   R0,#22
   000185 76 00    MOV   @R0,#00
   000187 d8 fc    DJNZ  R0,0185
> <font color="#118811">bse wi f 6</font>
> <font color="#118811">g</font>
4
   000170 7f 00    MOV   R7,#00
> </pre>


<a name="clear"><h3>clear [addr...]</h3></a>

Delete fetch breakpoint. Parameter specifies address of breakpoint. If
there is no breakpoint specified at given address this command prints
out a warning message.

<p>If parameter is not given then breakpoint at current PC will be
deleted if it exists. If more than one address is specified then all
breakpoints at specified addresses will be deleted.

<pre>
> <font color="#118811">i b</font>
Num Type       Disp Hit   Cnt   Address  What
1   fetch      keep 1     1     0x000160 CLR   P1.0
2   fetch      del  1     1     0x000180 LJMP  022a
1   event      keep 1     1     0x000006 wi
> <font color="#118811">clear 160</font>
No breakpoint at 0000a0
> <font color="#118811">clear 0x160</font>
> <font color="#118811">i b</font>
Num Type       Disp Hit   Cnt   Address  What
2   fetch      del  1     1     0x000180 LJMP  022a
1   event      keep 1     1     0x000006 wi
> </pre>


<a name="bde"><h3>bde wi|ri|wx|rx|ws|rs|rc addr</h3></a>

Delete event breakpoint. First parameter must be given to specify type
of event. Second parameter is address of memory cell which the
breakpoint is associated to. Continuing example given above:

<pre>
> <font color="#118811">bl</font>
D 2(2) 000180 02 LJMP  022a
F 1(1) 000006 wi
> <font color="#118811">bde ri 6</font>
No ri breakpoint at 000006
> <font color="#118811">bde wi 6</font>
> <font color="#118811">bl</font>
D 2(2) 000180 02 LJMP  022a
> </pre>


<a name="ba"><h3>ba</h3></a>

Delete all breakpoints. This command deletes all fetch as well as
event breakpoints. Be carefull because it does not ask you to confirm
your intention.

<pre>
> <font color="#118811">bl</font>
F 1(1) 000160 c2 CLR   P1.0
D 2(2) 000180 02 LJMP  022a
F 1(1) 000006 wi
> <font color="#118811">ba</font>
> <font color="#118811">bl</font>
> </pre>


<hr>


                                                                 <!-- DUMP -->

<h2><a name="dump">Dump commands</a></h2>

<a name="dis"><h3><img src="burst.gif" alt="[Repeatable]"> dis
[start [offset [lines]]]</h3></a>

Disassemble code. This command can be used to list disassembled
instructions which discovered by the code analyzer. First two
parameters specify the address where the list starts. First parameter
is address where the command starts to search an instruction. This
search goes forward. When the first instruction marked by code
analyzer found the simulator skips as many instructions as you specify
in second parameter. If <b>offset</b> is negative the simulator goes
backward and skips specified number of instructions. Default value of
<b>start</b> parameter is last address which was listed by previous
<b>dis</b> command and default value of <b>offset</b> is -1. It means
you can make continuous list repeating parameterless <b>dis</b>
command.

<p>In third parameter you can specify how many instructions you want
to list. Default value is 20.

<pre>
$ <font color="#118811">s51 remoansi.hex</font>
ucsim 0.2.12, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
58659 bytes read from remoansi.hex
> <font color="#118811">dis</font>
   00d47e 22       RET
   000000 02 01 60 LJMP  0160
   000160 c2 90    CLR   P1.0
   000162 c2 97    CLR   P1.7
   000164 d2 b5    SETB  P3.5
   000166 d2 b4    SETB  P3.4
   000168 75 81 22 MOV   SP,#22
   00016b 75 d0 00 MOV   PSW,#00
   00016e 7e 00    MOV   R6,#00
   000170 7f 00    MOV   R7,#00
   000172 79 04    MOV   R1,#04
   000174 12 0d b8 LCALL 0db8
   000177 0f       INC   R7
   000178 d9 fa    DJNZ  R1,0174
   00017a 75 0b 00 MOV   0b,#00
   00017d 75 0c 00 MOV   0c,#00
   000180 02 02 2a LJMP  022a
   000183 78 22    MOV   R0,#22
   000185 76 00    MOV   @R0,#00
   000187 d8 fc    DJNZ  R0,0185
> <font color="#118811">bs f 0x180</font>
> <font color="#118811">bs d 0x189</font>
> <font color="#118811">dis 0x180 -3 10</font>
   000178 d9 fa    DJNZ  R1,0174
   00017a 75 0b 00 MOV   0b,#00
   00017d 75 0c 00 MOV   0c,#00
F  000180 02 02 2a LJMP  022a
   000183 78 22    MOV   R0,#22
   000185 76 00    MOV   @R0,#00
   000187 d8 fc    DJNZ  R0,0185
D  000189 22       RET
   00018a 90 09 ec MOV   DPTR,#09ec
   00018d ae 83    MOV   R6,DPH
> </pre>

If there is an <b>F</b> or <b>D</b> character at the beginning of the
line, it means that there is a fix or dynamic fetch breakpoint at
listed address. Next element on the list can be an asterix (<b>*</b>)
which means that the listed address is not marked by the code
analyzer. <b>dis</b> lists marked instructions only so asterix never
appears in the list. Next element of the list is address displayed as
six digit hexadecimal number. Address is followed by hexadecimal dump
of instruction's code. Last element of the list is disassembled
instruction. Every number appeared on the list is hexadecimal number.


<a name="dc"><h3><img src="burst.gif" alt="[Repeatable]"> dc
[start [stop]]</h3></a>

Disassembled dump of code memory area. This command simply produces
disassambled list of memory area specified by the parameters. Default
value of <b>start</b> parameter is last address listed by previous
<b>dc</b> command. If <b>stop</b> parameter is not given 20 lines are
listed.

<pre>
$ <font color="#118811">s51 remoansi.hex</font> 
ucsim 0.2.12, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
58659 bytes read from remoansi.hex
> <font color="#118811">dc</font>
   000000 02 01 60 LJMP  0160
 * 000003 02 00 3c LJMP  003c
 * 000006 ff       MOV   R7,A
 * 000007 ff       MOV   R7,A
 * 000008 ff       MOV   R7,A
 * 000009 ff       MOV   R7,A
 * 00000a ff       MOV   R7,A
 * 00000b 02 3b e0 LJMP  3be0
 * 00000e ff       MOV   R7,A
 * 00000f ff       MOV   R7,A
 * 000010 ff       MOV   R7,A
 * 000011 ff       MOV   R7,A
 * 000012 ff       MOV   R7,A
 * 000013 02 00 ac LJMP  00ac
 * 000016 ff       MOV   R7,A
 * 000017 ff       MOV   R7,A
 * 000018 ff       MOV   R7,A
 * 000019 ff       MOV   R7,A
 * 00001a ff       MOV   R7,A
 * 00001b ff       MOV   R7,A
 * 00001c ff       MOV   R7,A
> </pre>


<a name="dch"><h3><img src="burst.gif" alt="[Repeatable]"> dch
[start [stop]]</h3></a>

Hexadecimal dump of code memory area from address <b>start</b> to
address <b>stop</b>. Default value of start address is address of
following memory cell which was dumped by previous <b>dch</b>
command. If <b>stop</b> parameter is not given <b>dch</b> command
lists 10 lines 8 bytes per line.

<pre>
$ <font color="#118811">s51 remo.hex</font>
ucsim 0.2.24, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
58659 bytes read from remoansi.hex
> <font color="#118811">wc remo</font>
0013da 52 65 6d 6f             Remo
> <font color="#118811">dch 0x13da</font>
0013da 52 65 6d 6f 20 00 56 65 Remo .Ve
0013e2 72 73 69 6f 6e 20 31 2e rsion 1.
0013ea 30 20 00 43 6f 70 79 72 0 .Copyr
0013f2 69 67 68 74 20 28 63 29 ight (c)
0013fa 20 00 31 39 39 34 2c 39  .1994,9
001402 35 20 00 54 61 6c 6b 65 5 .Talke
00140a 72 20 42 74 2e 00 53 75 r Bt..Su
001412 6e 64 61 79 2e 00 4d 6f nday..Mo
00141a 6e 64 61 79 2e 00 54 68 nday..Th
001422 75 65 73 64 61 79 2e 00 uesday..
> </pre>

First element in every lines is address of first byte dumped out in
the line. Next elements are hexadecimal values of bytes followed by
ASCII charactes of bytes dumped out in the line. If value of the
memory cell is not printable than a dot is dumped out.


<a name="di"><h3><img src="burst.gif" alt="[Repeatable]"> di
[start [stop]]</h3></a>

Hexadecimal dump of internal RAM area from address <b>start</b> to
address <b>stop</b>. Default value of start address is address of
following memory cell which was dumped by previous <b>di</b>
command. If <b>stop</b> parameter is not given <b>di</b> command
lists 10 lines 8 bytes per line.

<pre>
$ <font color="#118811">s51 remoansi.hex</font>
ucsim 0.2.24, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
58659 bytes read from remoansi.hex
> <font color="#118811">sopt stopit 1</font>
> <font color="#118811">g</font>
Simulation started, PC=0x000000
Stop at 000023: (5) Interrupt
F 000023
> <font color="#118811">di</font>
000000 18 02 16 ba 00 02 00 0a ........
000008 00 00 00 00 00 00 00 00 ........
000010 00 00 00 00 00 00 00 00 ........
000018 4a 00 00 00 00 00 00 00 J.......
000020 bc 27 06 2d 02 ee 35 8f .'.-..5.
000028 31 e7 42 01 0e 01 0b 00 1.B.....
000030 ec 0b 7f 10 7f a9 7e 08 ......~.
000038 fe 03 09 00 00 00 af 08 ........
000040 af 08 00 00 00 00 00 00 ........
000048 00 00 00 00 00 00 00 00 ........
> </pre>


<a name="dx"><h3><img src="burst.gif" alt="[Repeatable]"> dx
[start [stop]]</h3></a>

Hexadecimal dump of external RAM area from address <b>start</b> to
address <b>stop</b>. Default value of start address is address of
following memory cell which was dumped by previous <b>dx</b>
command. If <b>stop</b> parameter is not given <b>dx</b> command
lists 10 lines 8 bytes per line.

<pre>
$ <font color="#118811">s51 remoansi.hex</font>
ucsim 0.2.24, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
58659 bytes read from remoansi.hex
> <font color="#118811">sopt stopit 1</font>
> <font color="#118811">g</font>
Simulation started, PC=0x000000
Stop at 000023: (5) Interrupt
F 000023
> <font color="#118811">dx 0x100</font>
000100 00 00 00 00 00 00 00 00 ........
000108 00 00 00 00 00 00 00 00 ........
000110 00 00 00 00 00 00 00 00 ........
000118 00 00 00 00 00 00 00 00 ........
000120 00 00 00 00 00 00 00 00 ........
000128 00 00 00 00 00 00 00 44 .......D
000130 61 6e 69 00 00 00 02 02 ani.....
000138 07 00 00 ff 00 00 07 cb ........
000140 08 0c 32 00 07 cb 06 05 ..2.....
000148 02 00 24 00 00 00 00 00 ..$.....
> </pre>


<a name="dr"><h3><img src="burst.gif" alt="[Repeatable]">
dr</h3></a>

This command prints out actual value of important registers.

<pre>
$ <font color="#118811">s51 remoansi.hex</font> 
ucsim 0.2.12, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
58659 bytes read from remoansi.hex
> <font color="#118811">sopt stopit 1</font>
> <font color="#118811">g</font>
5
 * 000023 02 01 1c LJMP  011c
> <font color="#118811">dr</font>
000000 18 02 16 ba 00 02 00 0a ........
000018 4a J  ACC= 0x0a  10 .  B= 0x00   DPTR= 0x16ba @DPTR= 0x00   0 .
000002 16 .  PSW= 0x00 CY=0 AC=0 OV=0 P=0
 * 000023 02 01 1c LJMP  011c
> </pre>

In first line the actual register bank is dumped out. Register banks
reside in internal RAM, address at the begining of the line shows
start address of actual register bank selected by RS0 and RS1 bits of
PSW register.

<p>Next two lines begin with value of indirectly addressed internal
RAM cells. Second line shows IRAM cell pointed by R0 while third line
shows IRAM addressed by R1.

<p>Second line displays some important registers. First one is the
accumulator. Its value dumped out in hexadecimal, decimal form and
then the ASCII character of its value. It is followed by value of the
B register which is dumped out in hexadecimal form only. Next is DPTR
register in hexadecimal and then external RAM cell which is addressed
by DPTR. This is dumped out in hexadecimal, decimal and ASCII too.

<p>In third line you find program status word in hexadecimal and then
some flag bits of PSW register. Last line is disassembled instruction
at PC.


<a name="dp"><h3>dp</h3></a>

Dump out ports. This command shows actual value of ports.

<pre>
$ <font color="#118811">s51 remoansi.hex</font> 
ucsim 0.2.12, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
58659 bytes read from remoansi.hex
> <font color="#118811">sopt stopit 1</font>
> <font color="#118811">g</font>
5
 * 000023 02 01 1c LJMP  011c
> <font color="#118811">dp</font>
P0    11111111 0xff 255 .    P1    11111110 0xfe 254 .
Pin0  11111111 0xff 255 .    Pin1  11111111 0xff 255 .
Port0 11111111 0xff 255 .    Port1 11111110 0xfe 254 .

P2    11111111 0xff 255 .    P3    11111111 0xff 255 .
Pin2  11111111 0xff 255 .    Pin3  11111111 0xff 255 .
Port2 11111111 0xff 255 .    Port3 11111111 0xff 255 .
> </pre>

First lines on the list (labeled with Px) are value of SFRs which are
internal latch registers. Second lines (labeled with Pinx) are outputs
of external devices connected to port pins of the
microcontroller. These values can be set by you using <a
href="#sp"><b>sp</b></a> command. Third lines (labeled with Portx)
show actual values can be measured on pins of the device. These values
are calculated with following pseudo formula:

<p><tt>Portx= Px AND Pinx</tt>

<p>All three values are displayed in binary, hexadecimal, decimal form
and then the ASCII character of the value is shown.


<a name="ds"><h3>ds [addr...]</h3></a>

Print out SFR. This command can be used to get value of all or some
SFRs. If you do not specify any parameter the <b>ds</b> command simply
dumps out full SFR area 16 bytes per line.

<pre>
$ <font color="#118811">s51 remoansi.hex</font> 
ucsim 0.2.12, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
58659 bytes read from remoansi.hex
> <font color="#118811">sopt stopit 1</font>
> <font color="#118811">g</font>
5
 * 000023 02 01 1c LJMP  011c
> <font color="#118811">ds</font>
000080 ff 2a ba 16 00 00 00 00 55 a1 d7 fe 50 fd 00 00 .*......U...P...
000090 fe 00 00 00 00 00 00 00 7e 00 00 00 00 00 00 00 ........~.......
0000a0 ff 00 00 00 00 00 00 00 97 00 00 00 00 00 00 00 ................
0000b0 ff 00 00 00 00 00 00 00 15 00 00 00 00 00 00 00 ................
0000c0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
0000d0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
0000e0 0a 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
0000f0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
> <font color="#118811">ds p1 0x87</font>
    P1 fe 254 .
000087 00   0 .
> <font color="#118811">ds p2 ip scon</font>
    P2 ff 255 .
    IP 15  21 .
  SCON 7e 126 ~
> </pre>

If you specify one or more parameter the <b>ds</b> command prints out
value of registers specified by parameters. Parameter can be an
address or a symbolic name of the register. Note that the simulator
implements a register at all address in the address space which is not
true in real microcontroller where reading of an unimplemented
register gets undefined value. Value of the registers printed out in
hexadecimal, decimal, and ASCII form.

<p>Note that different type of controllers can implement different
registers:

<pre>
$ <font color="#118811">s51</font>
ucsim 0.2.12, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
> <font color="#118811">ds rcap2l</font>
> <font color="#118811">q</font>
$ <font color="#118811">s51 -t 52</font>
ucsim 0.2.12, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
> <font color="#118811">ds rcap2l</font>
RCAP2L 00   0 .
> </pre>


<a name="db"><h3><img src="burst.gif" alt="[Repeatable]"> db
addr...</h3></a>

Dump bits. This command can be used to get value of bits. At least one
parameter must be given. Bit address can be specified in three
forms. First of all name of the bit can be used if it has any. Direct
bit address is accepted too and it can be specified by address of IRAM
or SFR which contains the bit and bit number within the byte separated
by a dot. If the requested bit is in an SFR the address of the
register can be specified by its name.

<pre>
$ <font color="#118811">s51</font>
ucsim 0.2.12, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
> <font color="#118811">db it1 0x20.3 0x43 p2.5</font>
000088    IT1 0
000020   20.3 0
000028   28.3 0
0000a0   P2.5 1
> </pre>

Value of bits are printed out one per line. The list starts direct
address of the bit followed by bit name or address of the memory cell
or SFR which contains the displayed bit and bit number within the byte
separated by a dot. At last the value of the bit is shown. Displaying
a port bit you get value of SFR latch:

<pre>
> <font color="#118811">sp 1 0x0f</font>
> <font color="#118811">ss p1 0x55</font>
000090 55                                              U
> <font color="#118811">dp</font>
P0    11111111 0xff 255 .    P1    01010101 0x55  85 U
Pin0  11111111 0xff 255 .    Pin1  00001111 0x0f  15 .
Port0 11111111 0xff 255 .    Port1 00000101 0x05   5 .

P2    11111111 0xff 255 .    P3    11111111 0xff 255 .
Pin2  11111111 0xff 255 .    Pin3  11111111 0xff 255 .
Port2 11111111 0xff 255 .    Port3 11111111 0xff 255 .
> <font color="#118811">db p1.2 p1.3 p1.4 p1.5 p1.6</font>
000090   P1.2 1
000090   P1.3 0
000090   P1.4 1
000090   P1.5 0
000090   P1.6 1
> </pre>


<hr>


                                                                  <!-- SET -->

<h2><a name="set">Set commands</a></h2>

Set commands can be used to set value of memory cells, bits, or port
pins. Those commands that set value of memory interpret their command
lines a litle bit different than other commands. First parameter is
always the start address of the memory area which is being set. This
parameter is followed by a list of data parameters. Data can be
specified by a number. Numbers must begin with a digit. Each number
specifies one byte of data. If the parameter begins with a non-digit
character, it is interpreted as string of characters and this kind of
parameter specifies as many bytes as many characters the string
has. Strings can contain escape sequencies (see description of <a
href="#wi"><b>wi</b></a> command where escape sequencies are
discussed) but they can not contain spaces because space characters
(space, tabulator and vertical tabulator) separates parameters. Spaces
can be specified as escape sequences or separated number parameters if
needed. Only space characters separate data parameters while normaly
comma (<tt>,</tt>) and semicolon (<tt>;</tt>) are interpreted as
separator characters too.

<a name="si"><h3>si addr data...</h3></a>

Write data into internal RAM area. First parameter specifies start
address of memory area to set and other parameters are data to set.

<pre>
$ <font color="#118811">s51</font>
ucsim 0.2.12, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
> <font color="#118811">si 10 dani\040hej-ho</font>
00000a 64 61 6e 69 20 68 65 6a 2d 68 6f                dani hej-ho
> </pre>

Result of the command is a memory dump of area which has been modified
by the command. If there is syntax error in a data parameter then
remaining parameters are dropped out.

<pre>
> <font color="#118811">si 20 1 2 0xi 3 4</font>
Bad data 0xi
000014 01 02                                           ..
> </pre>


<a name="sx"><h3>sx addr data...</h3></a>

This command is similar to <a href="#si"><b>si</b></a> command
described above but it is used to modify external RAM.


<a name="sc"><h3>sc addr data...</h3></a>

This command is similar to <a href="#si"><b>si</b></a> command
described above but it is used to modify code memory area (ROM).


<a name="ss"><h3>ss addr data...</h3></a>

This command is similar to <a href="#si"><b>si</b></a> command
described above but it is used to modify SFR. Other difference is that
first parameter (<b>start</b> address) can be specified by name of SFR
not by address only.

<pre>
$ <font color="#118811">s51</font>
ucsim 0.2.12, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
> <font color="#118811">ss p1 0</font>
000090 00                                              .
> </pre>


<a name="sb"><h3>sb addr data...</h3></a>

Modify bit(s). First parameter is address of first bit to modify. See
description of <a href="#db"><b>db</b></a> command how bit address can
be specified. If first character of data parameter is <tt>0</tt> it
means <i>zero</i> otherwise it means <i>one</i>.

<pre>
$ <font color="#118811">s51</font>
ucsim 0.2.12, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
> <font color="#118811">sb 0x23.5 1</font>
> <font color="#118811">db 0x23.5</font>
000023   23.5 1
> <font color="#118811">sb p3.3 0</font>
> <font color="#118811">dp</font>
P0    11111111 0xff 255 .    P1    11111111 0xff 255 .
Pin0  11111111 0xff 255 .    Pin1  11111111 0xff 255 .
Port0 11111111 0xff 255 .    Port1 11111111 0xff 255 .

P2    11111111 0xff 255 .    P3    11110111 0xf7 247 .
Pin2  11111111 0xff 255 .    Pin3  11111111 0xff 255 .
Port2 11111111 0xff 255 .    Port3 11110111 0xf7 247 .
> <font color="#118811">sb tr1 0</font>
> <font color="#118811">db tr1</font>
000088    TR1 0
> <font color="#118811">sb tr1 1</font>
> <font color="#118811">db tr1</font>
000088    TR1 1
> </pre>


<a name="sp"><h3>sp port data</h3></a>

This command can be used to sep up output values of external circuits
connected to port pins. If a port bit is used as output to drive
external circuits, do not set corresponding pin bit to zero because
read back value of the port can be false. First parameter must be
number of the port between 0 and 3.

<pre>
$ <font color="#118811">s51</font>
ucsim 0.2.12, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
> <font color="#118811">dp</font>
P0    11111111 0xff 255 .    P1    11111111 0xff 255 .
Pin0  11111111 0xff 255 .    Pin1  11111111 0xff 255 .
Port0 11111111 0xff 255 .    Port1 11111111 0xff 255 .

P2    11111111 0xff 255 .    P3    11111111 0xff 255 .
Pin2  11111111 0xff 255 .    Pin3  11111111 0xff 255 .
Port2 11111111 0xff 255 .    Port3 11111111 0xff 255 .
> <font color="#118811">ss p1 0x55</font>
000090 55                                              U
> <font color="#118811">sp 1 0x0f</font>
> <font color="#118811">dp</font>
P0    11111111 0xff 255 .    P1    01010101 0x55  85 U
Pin0  11111111 0xff 255 .    Pin1  00001111 0x0f  15 .
Port0 11111111 0xff 255 .    Port1 00000101 0x05   5 .

P2    11111111 0xff 255 .    P3    11111111 0xff 255 .
Pin2  11111111 0xff 255 .    Pin3  11111111 0xff 255 .
Port2 11111111 0xff 255 .    Port3 11111111 0xff 255 .
> </pre>


<a name="fi"><h3>fi start stop data</h3></a>

Fill command. It can be used to fill up an area of internal RAM with a
specified data.

<pre>
$ <font color="#118811">s51</font>
ucsim 0.2.12, Copyright (C) 1997 Daniel Drotos, Talker Bt.
ucsim comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
> <font color="#118811">fi 11 0x34 44</font>
> <font color="#118811">di</font>
000000 00 00 00 00 00 00 00 00 ........
000008 00 00 00 2c 2c 2c 2c 2c ...,,,,,
000010 2c 2c 2c 2c 2c 2c 2c 2c ,,,,,,,,
000018 2c 2c 2c 2c 2c 2c 2c 2c ,,,,,,,,
000020 2c 2c 2c 2c 2c 2c 2c 2c ,,,,,,,,
000028 2c 2c 2c 2c 2c 2c 2c 2c ,,,,,,,,
000030 2c 2c 2c 2c 2c 00 00 00 ,,,,,...
000038 00 00 00 00 00 00 00 00 ........
000040 00 00 00 00 00 00 00 00 ........
000048 00 00 00 00 00 00 00 00 ........
> </pre>


<a name="fx"><h3>fx start stop data</h3></a>

Fill command. It works similar to <a href="#fi"><b>fi</b></a> but it
puts data into external RAM instead of internal RAM.


<a name="fs"><h3>fs start stop data</h3></a>

Fill command. It works similar to <a href="#fi"><b>fi</b></a> but it
puts data into SFR instead of internal RAM.


<a name="fc"><h3>fc start stop data</h3></a>

Fill command. It works similar to <a href="#fi"><b>fi</b></a> but it
puts data into code memory (ROM) instead of internal RAM.


<hr>

</body>
</html>
